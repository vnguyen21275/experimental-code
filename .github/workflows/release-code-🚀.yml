name: Release Code

# Invoke the workflow after the Create Tag workflow has succeeded
on:
  workflow_run:
    workflows: [Create Tag]
    types: [completed]

jobs:
  release_tag:
    name: Tagged Release 
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == success }}

    steps:
      - uses: actions/checkout@v2.2.0
        with:
          fetch-depth: 0 # Required due to the way Git works; without it, this action won't be able to find any of the correct tags
      - name: Get Latest Tag
        id: latest_tag
        uses: WyriHaximus/github-action-get-previous-tag@v1

      - name: Release the Latest Tag
        uses: marvinpinto/action-automatic-releases@v1.2.1
        with:
          repo_token: ${{ secrets.GITHUB_TOKEN }}
          automatic_release_tag: ${{ steps.latest_tag.outputs.tag }}
          prerelease: false
          title: ${{ steps.latest_tag.outputs.tag }} Wacky Woohoo Pizza Time!!@! üçïüöÄ
